<Page x:Class="Scrubbler.Host.Presentation.MainPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:local="using:Scrubbler.Host.Presentation"
      xmlns:navigation="using:Scrubbler.Host.Presentation.Navigation"
      xmlns:muxc="using:Microsoft.UI.Xaml.Controls"
      Background="{ThemeResource BackgroundBrush}">

    <muxc:NavigationView
        MenuItemsSource="{Binding Items}"
        SelectedItem="{Binding SelectedItem, Mode=TwoWay}"
        IsBackButtonVisible="Collapsed"
        IsPaneToggleButtonVisible="True"
        IsSettingsVisible="False"
        PaneDisplayMode="Left"
        CompactPaneLength="80">

        <!-- Template for NavigationView Items -->
        <muxc:NavigationView.MenuItemTemplate>
            <DataTemplate x:DataType="navigation:NavigationItemViewModel">
                <muxc:NavigationViewItem Content="{x:Bind Title}"
                                         SelectsOnInvoked="{x:Bind HasChildren, Mode=OneWay, Converter={StaticResource InverseBooleanConverter}}">
                    <muxc:NavigationViewItem.Icon>
                        <muxc:IconSourceElement IconSource="{x:Bind Icon}" />
                    </muxc:NavigationViewItem.Icon>
                    <muxc:NavigationViewItem.MenuItemsSource>
                        <Binding Path="Children" />
                    </muxc:NavigationViewItem.MenuItemsSource>
                </muxc:NavigationViewItem>
            </DataTemplate>
        </muxc:NavigationView.MenuItemTemplate>


        <!-- 📌 ALL MAIN UI CONTENT GOES HERE -->
        <muxc:NavigationView.Content>

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Global InfoBar -->
                <InfoBar x:Name="GlobalInfoBar"
                         Title="Notification"
                         IsOpen="False"
                         HorizontalAlignment="Center"
                         VerticalAlignment="Top"
                         Margin="16"
                         IsClosable="False" />

                <!-- Page or Plugin View -->
                <ContentPresenter Grid.Row="1"
                                  Content="{Binding CurrentViewModel}"
                                  ContentTemplateSelector="{StaticResource ViewLocatorSelector}" />
            </Grid>

        </muxc:NavigationView.Content>

    </muxc:NavigationView>
</Page>
